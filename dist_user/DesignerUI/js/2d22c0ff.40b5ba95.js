(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["2d22c0ff"],{f241:function(e,t,o){"use strict";o.r(t);var l,n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("q-layout",{attrs:{view:"hHh lpR fFf"}},[o("q-header",{attrs:{elevated:""}},[o("q-toolbar",{attrs:{glossy:"mat"===e.$q.theme,inverted:"ios"===e.$q.theme}},[o("q-btn",{attrs:{flat:"",dense:"",round:"","aria-label":"Sources"},on:{click:function(t){e.leftDrawerOpen=!e.leftDrawerOpen}}},[o("q-tooltip",[e._v("\n          Create new Blocks\n        ")]),o("q-icon",{attrs:{name:"widgets"}})],1),o("q-toolbar-title",[e._v("\n        MarkLogic Data Hub - Visual Programming Plugin\n        "),o("div",{attrs:{slot:"subtitle"},slot:"subtitle"},[e._v("Draw your ideas")])]),o("q-btn-group",[o("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"folder_open",size:"lg"},on:{click:function(t){return t.stopPropagation(),e.loadDHFDefaultGraph()}}},[o("q-tooltip",[e._v("\n            Reset the graph with a default DHF config\n          ")])],1),o("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"cloud_upload",size:"lg"},on:{click:function(t){return t.stopPropagation(),e.saveGraph()}}},[o("q-tooltip",[e._v("\n            Save current grap to the staging DB\n          ")])],1),o("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"cloud_download",size:"lg"},on:{click:function(t){return t.stopPropagation(),e.loadGraph()}}},[o("q-tooltip",[e._v("\n            Load a graph from the staging DB\n          ")])],1),o("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"play_arrow",size:"lg"},on:{click:function(t){return t.stopPropagation(),e.executeGraph()}}},[o("q-tooltip",[e._v("\n            Preview Execute Graph\n          ")])],1),o("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"code",size:"lg"},on:{click:function(t){return t.stopPropagation(),e.exportDHFModule()}}},[o("q-tooltip",[e._v("\n            Export DHF custom step module\n          ")])],1)],1)],1)],1),o("q-drawer",{attrs:{elevated:"",bordered:"","content-class":"bg-grey-2",side:"left",width:500},model:{value:e.leftDrawerOpen,callback:function(t){e.leftDrawerOpen=t},expression:"leftDrawerOpen"}},[o("q-card",[o("q-tabs",{staticClass:"text-grey",attrs:{dense:"","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[o("q-tab",{attrs:{name:"sources",label:"From Sources"}}),o("q-tab",{attrs:{name:"entities",label:"From Entities"}}),o("q-tab",{attrs:{name:"csv",label:"From Csv"}})],1),o("q-separator"),o("q-tab-panels",{attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[o("q-tab-panel",{attrs:{name:"sources"}},[o("modelselector")],1),o("q-tab-panel",{attrs:{name:"entities"}},[o("entityselector")],1),o("q-tab-panel",{attrs:{name:"csv"}},[o("csv-loader")],1)],1)],1)],1),o("q-page-container",[o("router-view")],1)],1)},a=[],i=o("c47a"),s=o.n(i),r=o("0967"),c=o("2b0e"),d=function(e,t){var o=window.open;if(!0===r["a"].is.cordova){if(void 0!==cordova&&void 0!==cordova.InAppBrowser&&void 0!==cordova.InAppBrowser.open)o=cordova.InAppBrowser.open;else if(void 0!==navigator&&void 0!==navigator.app)return navigator.app.loadUrl(e,{openExternal:!0})}else if(void 0!==c["a"].prototype.$q.electron)return c["a"].prototype.$q.electron.shell.openExternal(e);var l=o(e,"_blank");if(l)return l.focus(),l;t&&t()},u=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"column gutter-sm"},[o("div",{staticClass:"q-title"},[e._v("Create block from Sources")]),o("q-input",{attrs:{"stack-label":"",label:"Block name"},model:{value:e.blockName,callback:function(t){e.blockName=t},expression:"blockName"}}),o("q-select",{staticClass:"bg-secondary",attrs:{name:"collectionSelector",options:e.availableCollections,inverted:"",separator:"",label:"Select a collection","stack-label":""},on:{"update:options":function(t){e.availableCollections=t},input:e.collectionChanged},model:{value:e.selectedCollection,callback:function(t){e.selectedCollection=t},expression:"selectedCollection"}}),o("q-input",{attrs:{"bottom-slots":"",label:"Add custom field"},scopedSlots:e._u([{key:"append",fn:function(){return[o("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"add"},on:{click:function(t){return e.addCustomField()}}})]},proxy:!0}]),model:{value:e.newCustomFieldName,callback:function(t){e.newCustomFieldName=t},expression:"newCustomFieldName"}}),e._m(0),o("q-tree",{ref:"selectionTree",attrs:{nodes:e.collectionModel,"node-key":"label","tick-strategy":"strict",ticked:e.selectedFields},on:{"update:ticked":function(t){e.selectedFields=t}}}),o("div",{staticClass:"q-body-1"},[e._v("Select the generation options")]),o("q-option-group",{attrs:{color:"secondary",type:"toggle",options:[{label:"Get doc by URI",value:"getByUri"},{label:"Node as input",value:"nodeInput"},{label:"Node as output",value:"nodeOutput"},{label:"Create fields inputs",value:"fieldsInputs"},{label:"Create fields outputs",value:"fieldsOutputs"}]},model:{value:e.blockOptions,callback:function(t){e.blockOptions=t},expression:"blockOptions"}}),o("q-btn-group",[o("q-btn",{attrs:{label:"Create block"},on:{click:function(t){return e.notifyBlockRequested()}}},[o("q-tooltip",[e._v("\n        Create and add the block top the library\n      ")])],1),o("q-btn",{attrs:{label:"Save"},on:{click:function(t){return e.saveBlock()}}},[o("q-tooltip",[e._v("\n        Save the block definition to the staging DB\n      ")])],1)],1),o("q-list",{staticClass:"q-mt-md",attrs:{link:""}},[o("q-item-label",[e._v("Existing model definitions")]),e._l(e.savedBlocks,(function(t,l){return o("q-item",{key:t.name,attrs:{tag:"label"},nativeOn:{click:function(o){return e.getSavedBlock(t.uri)}}},[o("q-item-label",[o("q-item-section",{attrs:{label:""}},[e._v(e._s(t.name))])],1)],1)}))],2)],1)},p=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"q-body-1"},[o("p",[e._v("Select the fields to add")])])}],f=(o("7f7f"),{data:function(){var e;return e={selectedCollection:"",selectedFields:null,selectedFieldsNodes:null},s()(e,"selectedCollection",null),s()(e,"availableCollections",[]),s()(e,"collectionModel",[{label:"source",children:[]},{label:"custom",children:[]}]),s()(e,"blockOptions",["nodeInput","fieldsOutputs"]),s()(e,"savedGraph",[]),s()(e,"savedBlocks",[]),s()(e,"blockName",""),s()(e,"newCustomFieldName",""),e},methods:{selectFieldPath:function(e){console.log(e)},collectionChanged:function(){console.log(this.selectedCollection),this.discoverModel(this.selectedCollection)},addCustomField:function(){this.collectionModel[1].children.push({label:this.newCustomFieldName,children:[]})},discoverCollections:function(){var e=this;this.$axios.get("/v1/resources/collectionsDiscovery").then((function(t){e.availableCollections=t.data})).catch((function(){e.$q.notify({color:"negative",position:"top",message:"Loading failed",icon:"report_problem"})}))},loadSavedBlocks:function(){var e=this;this.$axios.post("/v1/resources/savedBlock").then((function(t){e.savedBlocks=t.data})).catch((function(){e.$q.notify({color:"negative",position:"top",message:"Loading failed",icon:"report_problem"})}))},getSavedBlock:function(e){var t=this;this.$axios.get("/v1/resources/savedBlock?rs:uri="+encodeURI(e)).then((function(e){var o=e.data;null!=o&&(t.blockName=o.name,t.selectedCollection.value=o.collection,t.selectedFields=o.fields,t.blockOptions=o.options)})).catch((function(){t.$q.notify({color:"negative",position:"top",message:"Loading failed",icon:"report_problem"})}))},saveBlock:function(){var e=this,t={name:this.blockName,collection:this.selectedCollection,source:"Sources",fields:this.selectedFields,options:this.blockOptions};this.$axios.put("/v1/resources/savedBlock",t).then((function(t){e.savedGraph=t.data})).catch((function(){e.$q.notify({color:"negative",position:"top",message:"Loading failed",icon:"report_problem"})}))},discoverModel:function(e){var t=this;this.$axios.get("/v1/resources/modelDiscovery?rs:collection="+e.value).then((function(e){t.collectionModel[0].children=e.data})).catch((function(){t.$q.notify({color:"negative",position:"top",message:"Loading failed",icon:"report_problem"})}))},notifyBlockRequested:function(){if(null==this.blockName||""==this.blockName)this.$q.notify({color:"negative",position:"top",message:"Please set the block name",icon:"report_problem"});else{var e={label:this.blockName,collection:this.blockName,source:"Sources",fields:this.$refs["selectionTree"].getTickedNodes(),options:this.blockOptions};this.$root.$emit("blockRequested",e)}}},mounted:function(){console.log("Nothing gets called before me!"),this.discoverCollections(),this.loadSavedBlocks()}}),v=f,b=o("2877"),h=Object(b["a"])(v,u,p,!1,null,null,null),m=h.exports,g=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("q-modal",{attrs:{position:"right"},model:{value:e.opened,callback:function(t){e.opened=t},expression:"opened"}},[o("q-modal-layout",[o("q-toolbar",{attrs:{slot:"header"},slot:"header"},[o("q-btn",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],attrs:{flat:"",round:"",dense:"",icon:"keyboard_arrow_left"}}),o("q-toolbar-title",[e._v("\n          Result\n        ")])],1),o("div",{staticClass:"layout-padding"},[o("h6",[e._v("Execution graph result")]),o("p",[e._v("This is the result of the execution")]),o("vue-json-pretty",{attrs:{data:e.json2Render}}),o("q-btn",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],attrs:{color:"primary",label:"Close"},on:{click:function(t){e.opened=!1}}})],1),o("q-toolbar",{attrs:{slot:"footer"},slot:"footer"},[o("q-toolbar-title")],1)],1)],1)],1)},k=[],q=o("d538"),y=o.n(q),C={data:function(){return{opened:!1,json2Render:{},search:""}},methods:{showResult:function(e){this.opened=!0,this.json2Render=e}},mounted:function(){this.$root.$on("resultReceived",this.showResult)},components:{VueJsonPretty:y.a}},_=C,$=Object(b["a"])(_,g,k,!1,null,null,null),w=$.exports,x=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"column gutter-sm"},[o("div",{staticClass:"q-title"},[e._v("Create block from DHF Entities")]),o("q-select",{staticClass:"bg-secondary",attrs:{name:"collectionSelector",options:e.availableEntities,inverted:"",separator:"","stack-label":"",label:"Select an entity"},on:{"update:options":function(t){e.availableEntities=t},input:e.entityChanged},model:{value:e.selectedEntity,callback:function(t){e.selectedEntity=t},expression:"selectedEntity"}}),o("q-table",{attrs:{title:"Properties of the entity",data:e.entityModel.children,columns:e.columns,"row-key":"name"}}),o("q-btn-group",[o("q-btn",{attrs:{label:"Create block"},on:{click:function(t){return e.notifyBlockRequested()}}},[o("q-tooltip",[e._v("\n            Create and add the block top the library (right click)\n          ")])],1)],1)],1)},E=[],B={data:function(){return{availableEntities:[],selectedEntity:null,entityModel:{children:[]},columns:[{name:"Property",required:!0,label:"Property",align:"left",field:"label",sortable:!0,style:"font-size: 10px"},{name:"Type",required:!0,label:"Type",align:"left",field:"type",sortable:!0,style:"font-size: 8px"}]}},methods:{getEntities:function(){var e=this;this.$axios.get("/v1/resources/dhfEntities").then((function(t){e.availableEntities=t.data})).catch((function(){e.$q.notify({color:"negative",position:"top",message:"Loading entities failed",icon:"report_problem"})}))},entityChanged:function(){var e=this;this.$axios.get("/v1/resources/dhfEntityProperties?rs:entity="+this.selectedEntity.value).then((function(t){e.entityModel=t.data}))},notifyBlockRequested:function(){var e=this,t=this.availableEntities.filter((function(t){return t.value==e.selectedEntity.value}))[0],o={label:t.label,collection:t.label,source:"Entities",fields:this.entityModel.children.map((function(e){return{label:e.label,field:e.label,path:"//"+e.label}})),options:["fieldsInputs","nodeOutput"]};this.$root.$emit("blockRequested",o)},saveBlock:function(){var e=this,t=this.availableEntities.filter((function(t){return t.value==e.selectedEntity.value}))[0],o={label:t.label,collection:t.label,source:"Entities",fields:this.entityModel.children.map((function(e){return e.label})),options:["fieldsInputs","nodeOutput"]};this.$axios.put("/v1/resources/savedBlock",o).then((function(t){e.savedGraph=t.data})).catch((function(){e.$q.notify({color:"negative",position:"top",message:"Loading failed",icon:"report_problem"})}))}},mounted:function(){console.log("Nothing gets called before me!"),this.getEntities()}},F=B,D=Object(b["a"])(F,x,E,!1,null,null,null),O=D.exports,N=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"column gutter-sm"},[o("q-input",{attrs:{filled:"",label:"Mapping file (in statics)"},model:{value:e.filename,callback:function(t){e.filename=t},expression:"filename"}},[o("q-tooltip",[e._v("\n    format: source;sourceField;target;targetField;type\n  ")])],1),o("q-btn-group",[o("q-btn",{attrs:{label:"Create block"},on:{click:function(t){return e.createBlock()}}},[o("q-tooltip",[e._v("\n      Create and add the block top the library (right click)\n    ")])],1)],1)],1)},R=[],S={data:function(){return{filename:"mappingRules.csv"}},methods:{createBlock:function(){var e=this;this.$axios.get("/statics/"+this.filename).then((function(t){e.$root.$emit("csvLoadingRequested",t.data)}))}}},G=S,M=Object(b["a"])(G,N,R,!1,null,null,null),P=M.exports,L=(l={name:"MyLayout",data:function(){return{leftDrawerOpen:this.$q.platform.is.desktop,rightDrawerOpen:this.$q.platform.is.desktop,tab:"sources"}},methods:{openURL:d}},s()(l,"methods",{openURL:d,notify:function(){this.$root.$emit("registerModel"),console.log("emit")},executeGraph:function(){this.$root.$emit("executeGraphCall")},saveGraph:function(){this.$root.$emit("saveGraphCall")},loadGraph:function(){this.$root.$emit("loadGraphCall")},exportDHFModule:function(){this.$root.$emit("exportGraphCall")},loadDHFDefaultGraph:function(){this.$root.$emit("loadDHFDefaultGraphCall"),this.leftDrawerOpen=!1}}),s()(l,"components",{modelselector:m,resultViewer:w,entityselector:O,csvLoader:P}),l),j=L,H=Object(b["a"])(j,n,a,!1,null,null,null);t["default"]=H.exports}}]);